DROP TABLE IF EXISTS DataSets
DROP TABLE IF EXISTS DataSets_Relationships

DROP SEQUENCE IF EXISTS SequenceDataSets

DROP PROCEDURE IF EXISTS DataSet_AddRecord
DROP PROCEDURE IF EXISTS DataSet_Create
DROP PROCEDURE IF EXISTS DataSet_Delete
DROP PROCEDURE IF EXISTS DataSet_DeleteRecord
DROP PROCEDURE IF EXISTS DataSet_GetAllColumns
DROP PROCEDURE IF EXISTS DataSet_GetColumns
DROP PROCEDURE IF EXISTS DataSet_GetInfo
DROP PROCEDURE IF EXISTS DataSet_UpdateColumns
DROP PROCEDURE IF EXISTS DataSet_UpdateInfo
DROP PROCEDURE IF EXISTS DataSet_UpdateRecord
DROP PROCEDURE IF EXISTS DataSets_GetList
DROP PROCEDURE IF EXISTS DataSets_Relationship_Create
DROP PROCEDURE IF EXISTS DataSets_Relationships_GetAll
DROP PROCEDURE IF EXISTS DataSets_Relationships_GetList

--remove all user-created datasets
DECLARE @sql nvarchar(MAX)
BEGIN TRY 
	SELECT @sql=STRING_AGG('DROP TABLE ' + TABLE_NAME, char(10)) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME LIKE 'DataSet_%'
	EXECUTE sp_executesql @sql
END TRY BEGIN CATCH END CATCH


--remove all user-created sequences
BEGIN TRY 
	SELECT @sql=STRING_AGG('DROP SEQUENCE ' + SEQUENCE_NAME, char(10)) FROM INFORMATION_SCHEMA.SEQUENCES WHERE SEQUENCE_NAME LIKE 'Sequence_DataSet_%'
	EXECUTE sp_executesql @sql
END TRY BEGIN CATCH END CATCH